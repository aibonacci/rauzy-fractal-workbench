# ğŸ¨ åˆ†å±‚æ¸²æŸ“é¢œè‰²é—®é¢˜ä¿®å¤

## ğŸš¨ é—®é¢˜è¯Šæ–­

ä»ç”¨æˆ·æˆªå›¾å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š

### é—®é¢˜1ï¼šèƒŒæ™¯åº”è¯¥æ˜¯ç°åº¦ï¼Œä½†æ˜¾ç¤ºä¸ºå½©è‰²
- **æœŸæœ›**ï¼šåˆæ¬¡åŠ è½½åæ˜¾ç¤ºä¸‰ç§ä¸åŒäº®åº¦çš„ç°è‰²ç“¦ç‰‡èƒŒæ™¯
- **å®é™…**ï¼šæ˜¾ç¤ºçº¢ã€ç»¿ã€è“ä¸‰è‰²ç“¦ç‰‡
- **åŸå› **ï¼šWebGLæ¸²æŸ“å™¨å¿½ç•¥äº†highlightGroupï¼Œåªæ ¹æ®baseTypeç€è‰²

### é—®é¢˜2ï¼šè·¯å¾„é«˜äº®å¤±æ•ˆ
- **æœŸæœ›**ï¼šæ·»åŠ è·¯å¾„(1,1)å’Œ(1,2)åï¼Œå¯¹åº”ç‚¹é›†åº”è¯¥é«˜äº®æ˜¾ç¤º
- **å®é™…**ï¼šæ²¡æœ‰çœ‹åˆ°ä»»ä½•é«˜äº®æ•ˆæœ
- **åŸå› **ï¼šé¢œè‰²æ˜ å°„é€»è¾‘å®Œå…¨å¿½ç•¥highlightGroupå­—æ®µ

## ğŸ” æ ¹å› åˆ†æ

### é”™è¯¯çš„é¢œè‰²æ˜ å°„é€»è¾‘
```typescript
// âŒ åŸæœ‰é”™è¯¯é€»è¾‘ï¼šåªè€ƒè™‘baseType
const colorMap = {
  '1': [1.0, 0.3, 0.3], // çº¢è‰²
  '2': [0.3, 1.0, 0.3], // ç»¿è‰²
  '3': [0.3, 0.3, 1.0], // è“è‰²
};

// å®Œå…¨å¿½ç•¥highlightGroup
const baseType = point.baseType || 'unknown';
const color = colorMap[baseType] || [0.7, 0.7, 0.7];
```

### é—®é¢˜è¡¨ç°
1. **æ‰€æœ‰ç‚¹éƒ½æŒ‰baseTypeç€è‰²**ï¼šæ— è®ºæ˜¯èƒŒæ™¯è¿˜æ˜¯é«˜äº®ï¼Œéƒ½æ˜¾ç¤ºå½©è‰²
2. **highlightGroupè¢«å¿½ç•¥**ï¼šåˆ†å±‚æ¸²æŸ“çš„æ ¸å¿ƒæ ‡è®°å®Œå…¨æ— æ•ˆ
3. **èƒŒæ™¯ä¸æ˜¯ç°åº¦**ï¼šè¿èƒŒäº†"ç°åº¦èƒŒæ™¯+è·¯å¾„é«˜äº®"çš„è®¾è®¡ç†å¿µ

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ­£ç¡®çš„åˆ†å±‚é¢œè‰²æ˜ å°„
```typescript
// ğŸ¨ åˆ†å±‚æ¸²æŸ“é¢œè‰²æ˜ å°„
// èƒŒæ™¯å±‚ï¼šä¸åŒäº®åº¦çš„ç°è‰²ï¼ˆæ ¹æ®baseTypeï¼‰
const backgroundColorMap = {
  '1': [0.4, 0.4, 0.4], // æ·±ç°è‰²
  '2': [0.6, 0.6, 0.6], // ä¸­ç°è‰²
  '3': [0.8, 0.8, 0.8], // æµ…ç°è‰²
};

// é«˜äº®å±‚ï¼šé²œæ˜çš„å½©è‰²ï¼ˆæ ¹æ®è·¯å¾„ç´¢å¼•ï¼‰
const highlightColorMap = [
  [1.0, 0.2, 0.2], // è·¯å¾„0ï¼šçº¢è‰²
  [0.2, 1.0, 0.2], // è·¯å¾„1ï¼šç»¿è‰²
  [0.2, 0.2, 1.0], // è·¯å¾„2ï¼šè“è‰²
  [1.0, 1.0, 0.2], // è·¯å¾„3ï¼šé»„è‰²
  [1.0, 0.2, 1.0], // è·¯å¾„4ï¼šç´«è‰²
  [0.2, 1.0, 1.0], // è·¯å¾„5ï¼šé’è‰²
];

// ğŸ¨ åˆ†å±‚æ¸²æŸ“é¢œè‰²é€»è¾‘
if (point.highlightGroup === -1) {
  // èƒŒæ™¯å±‚ï¼šæ ¹æ®baseTypeæ˜¾ç¤ºä¸åŒäº®åº¦çš„ç°è‰²
  const baseType = point.baseType || '1';
  color = backgroundColorMap[baseType] || [0.5, 0.5, 0.5];
} else {
  // é«˜äº®å±‚ï¼šæ ¹æ®highlightGroupæ˜¾ç¤ºé²œæ˜å½©è‰²
  const groupIndex = point.highlightGroup % highlightColorMap.length;
  color = highlightColorMap[groupIndex];
}
```

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
- âŒ èƒŒæ™¯æ˜¾ç¤ºä¸ºçº¢ç»¿è“ä¸‰è‰²
- âŒ è·¯å¾„é«˜äº®å®Œå…¨æ— æ•ˆ
- âŒ æ‰€æœ‰ç‚¹éƒ½æŒ‰baseTypeç€è‰²

### ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
- âœ… èƒŒæ™¯æ˜¾ç¤ºä¸ºä¸‰ç§ä¸åŒäº®åº¦çš„ç°è‰²
- âœ… è·¯å¾„é«˜äº®æ˜¾ç¤ºé²œæ˜å½©è‰²
- âœ… æ­£ç¡®çš„åˆ†å±‚æ¸²æŸ“æ•ˆæœ

## ğŸ¨ é¢œè‰²è®¾è®¡ç†å¿µ

### èƒŒæ™¯å±‚è®¾è®¡
- **baseType '1'**ï¼šæ·±ç°è‰² RGB(0.4, 0.4, 0.4)
- **baseType '2'**ï¼šä¸­ç°è‰² RGB(0.6, 0.6, 0.6)
- **baseType '3'**ï¼šæµ…ç°è‰² RGB(0.8, 0.8, 0.8)
- **ç›®çš„**ï¼šæä¾›å®Œæ•´çš„åˆ†å½¢ç»“æ„ä¸Šä¸‹æ–‡ï¼Œä¸æŠ¢å¤ºæ³¨æ„åŠ›

### é«˜äº®å±‚è®¾è®¡
- **è·¯å¾„0**ï¼šçº¢è‰² RGB(1.0, 0.2, 0.2)
- **è·¯å¾„1**ï¼šç»¿è‰² RGB(0.2, 1.0, 0.2)
- **è·¯å¾„2**ï¼šè“è‰² RGB(0.2, 0.2, 1.0)
- **è·¯å¾„3+**ï¼šé»„è‰²ã€ç´«è‰²ã€é’è‰²ç­‰
- **ç›®çš„**ï¼šçªå‡ºæ˜¾ç¤ºç”¨æˆ·å…³æ³¨çš„è·¯å¾„æ¨¡å¼

### è§†è§‰å±‚æ¬¡
```
ğŸ­ èƒŒæ™¯å±‚ï¼ˆç°åº¦ï¼‰: å®Œæ•´çš„åˆ†å½¢ç»“æ„
    +
ğŸŒˆ é«˜äº®å±‚ï¼ˆå½©è‰²ï¼‰: ç”¨æˆ·é€‰æ‹©çš„è·¯å¾„
    =
ğŸ¨ æœ€ç»ˆæ•ˆæœ: ç°åº¦èƒŒæ™¯ + å½©è‰²é«˜äº®
```

## ğŸ§ª éªŒè¯ç»“æœ

### é€»è¾‘éªŒè¯
è¿è¡Œ `node verify-color-logic.js`ï¼š
```
ç‚¹0: èƒŒæ™¯å±‚ baseType=1 -> ç°åº¦0.4 RGB(0.4, 0.4, 0.4)
ç‚¹1: èƒŒæ™¯å±‚ baseType=2 -> ç°åº¦0.6 RGB(0.6, 0.6, 0.6)
ç‚¹2: èƒŒæ™¯å±‚ baseType=3 -> ç°åº¦0.8 RGB(0.8, 0.8, 0.8)
ç‚¹3: é«˜äº®å±‚ group=0 -> å½©è‰²è·¯å¾„0 RGB(1, 0.2, 0.2)
ç‚¹4: é«˜äº®å±‚ group=1 -> å½©è‰²è·¯å¾„1 RGB(0.2, 1, 0.2)
```

### æ„å»ºéªŒè¯
```bash
npm run build
# âœ“ built in 1.90s
```

## ğŸ“Š é¢„æœŸç”¨æˆ·ä½“éªŒ

### åˆæ¬¡åŠ è½½
- æ˜¾ç¤ºå®Œæ•´çš„ç°åº¦åˆ†å½¢èƒŒæ™¯
- ä¸‰ç§baseTypeæ˜¾ç¤ºä¸ºä¸åŒäº®åº¦çš„ç°è‰²
- è§†è§‰ä¸Šç»Ÿä¸€è€Œä¸æ‚ä¹±

### æ·»åŠ è·¯å¾„å
- ç°åº¦èƒŒæ™¯ä¿æŒå®Œæ•´
- è·¯å¾„å¯¹åº”çš„ç‚¹é›†ä»¥é²œæ˜å½©è‰²é«˜äº®æ˜¾ç¤º
- ä¸åŒè·¯å¾„ä½¿ç”¨ä¸åŒé¢œè‰²åŒºåˆ†
- é«˜äº®ç‚¹å åŠ åœ¨èƒŒæ™¯ä¹‹ä¸Šï¼Œä¸ç ´åèƒŒæ™¯å®Œæ•´æ€§

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### é¢œè‰²æ•°æ®ç»“æ„
```typescript
interface RenderPoint {
  re: number;
  im: number;
  baseType: '1' | '2' | '3';
  highlightGroup: number; // -1ä¸ºèƒŒæ™¯ï¼Œ>=0ä¸ºé«˜äº®
}
```

### WebGLé¢œè‰²ç¼“å†²
```typescript
// ä¸ºæ¯ä¸ªç‚¹ç”ŸæˆRGBé¢œè‰²æ•°æ®
const colors = new Float32Array(points.length * 3);
for (let i = 0; i < points.length; i++) {
  const color = getPointColor(points[i]); // åˆ†å±‚é¢œè‰²é€»è¾‘
  colors[i * 3] = color[0];     // R
  colors[i * 3 + 1] = color[1]; // G
  colors[i * 3 + 2] = color[2]; // B
}
```

---

**æ€»ç»“**ï¼šé€šè¿‡ä¿®å¤WebGLæ¸²æŸ“å™¨çš„é¢œè‰²æ˜ å°„é€»è¾‘ï¼ŒæˆåŠŸå®ç°äº†æ­£ç¡®çš„åˆ†å±‚æ¸²æŸ“é¢œè‰²æ•ˆæœã€‚ç°åœ¨èƒŒæ™¯æ˜¾ç¤ºä¸ºç°åº¦ï¼Œè·¯å¾„é«˜äº®æ˜¾ç¤ºä¸ºå½©è‰²ï¼Œå®Œå…¨ç¬¦åˆ"ç°åº¦èƒŒæ™¯+è·¯å¾„é«˜äº®"çš„è®¾è®¡ç†å¿µã€‚ğŸ¨