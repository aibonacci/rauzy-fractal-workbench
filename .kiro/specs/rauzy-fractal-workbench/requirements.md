# 需求文档

## 介绍

Rauzy分形分析工作台是一个基于React的单页交互式Web应用，旨在提供专业级的可视化分析工具，用于研究三阶斐波那契（Tribonacci）符号序列的代数性质与其几何体现——劳齐分形（Rauzy Fractal）之间的深刻联系。该应用既服务于数学研究者的手动探索需求，也为AI agent提供了程序化的自主研究能力。用户和AI agent都可以通过标准化的界面构建、管理并同时探测多条复合路径，利用刘氏定理的精确公式实时计算这些代数模式对应的几何点集，并在分形上以不同颜色高亮显示。

## 需求

### 需求 1

**用户故事：** 作为研究者，我希望能够设置分形的总点数，以便控制计算精度和性能平衡。

#### 验收标准

1. 当用户调整点数滑块时，系统应当重新计算整个分形数据
2. 当点数范围在10,000到1,000,000之间时，系统应当支持实时调整
3. 当点数变更时，系统应当显示加载状态直到计算完成
4. 当计算完成后，系统应当更新画布显示新的分形图形

### 需求 2

**用户故事：** 作为研究者，我希望能够输入和管理复合路径，以便分析不同路径模式的几何特征。

#### 验收标准

1. 当用户输入路径字符串时，系统应当验证输入只包含1、2、3数字
2. 当用户添加新路径时，系统应当检查路径是否已存在避免重复
3. 当路径列表达到500条时，系统应当阻止继续添加并显示错误信息
4. 当用户删除路径时，系统应当立即从列表和可视化中移除该路径

### 需求 3

**用户故事：** 作为研究者，我希望能够在分形画布上看到不同路径的高亮显示，以便直观地观察路径对应的几何点集。

#### 验收标准

1. 当系统渲染分形时，基础点应当使用灰色透明度显示不同类型
2. 当路径被添加时，对应的点集应当用独特颜色高亮显示
3. 当多条路径同时存在时，每条路径应当使用不同的颜色进行区分
4. 当画布大小改变时，分形应当自动缩放以适应显示区域

### 需求 4

**用户故事：** 作为研究者，我希望能够查看每条路径的详细计算数据，以便验证刘氏定理的计算结果。

#### 验收标准

1. 当路径被添加时，系统应当计算并显示路径的r值（总权重）
2. 当路径数据计算完成时，系统应当显示C值（常数项）
3. 当路径有效时，系统应当显示首项坐标信息
4. 当路径计算完成时，系统应当显示位置数列的前5项

### 需求 5

**用户故事：** 作为研究者，我希望应用能够高效处理大规模数据计算，以便在处理百万级点数时保持界面响应。

#### 验收标准

1. 当执行重量级计算时，系统应当使用异步处理避免界面阻塞
2. 当计算进行中时，系统应当显示加载指示器
3. 当状态更新时，系统应当使用优化的渲染策略避免不必要的重计算
4. 当用户交互时，界面应当保持流畅响应

### 需求 6

**用户故事：** 作为研究者，我希望应用具有专业的三栏式布局，以便同时进行输入、可视化和数据分析。

#### 验收标准

1. 当应用加载时，左侧应当显示控制面板包含路径输入和点数调整
2. 当应用运行时，中间应当显示固定4:3比例的分形画布
3. 当路径存在时，右侧应当显示对应的数据分析面板
4. 当窗口大小改变时，布局应当保持响应式适配

### 需求 7

**用户故事：** 作为AI agent，我希望能够通过标准化的DOM元素和数据属性进行程序化操作，以便自主进行数学研究和实验。

#### 验收标准

1. 当界面元素渲染时，关键交互元素应当具有明确的data-testid属性
2. 当路径输入框存在时，应当具有可识别的标识符便于程序化输入
3. 当按钮和控件存在时，应当具有语义化的标签和属性
4. 当数据更新时，相关DOM元素应当反映最新状态便于程序读取

### 需求 8

**用户故事：** 作为开发者，我希望项目使用Vite构建系统，以便获得快速的开发体验和优化的生产构建。

#### 验收标准

1. 当项目初始化时，应当使用Vite作为构建工具
2. 当开发时，系统应当支持热模块替换（HMR）
3. 当构建生产版本时，应当生成优化的静态资源
4. 当依赖更新时，构建系统应当支持现代JavaScript特性

### 需求 9

**用户故事：** 作为研究者和AI agent，我希望应用提供一致的用户体验，以便人机协作进行数学研究。

#### 验收标准

1. 当人类用户操作时，界面应当提供直观的视觉反馈
2. 当AI agent操作时，系统应当保持相同的功能逻辑和数据一致性
3. 当错误发生时，系统应当提供清晰的错误信息便于调试
4. 当操作完成时，系统状态应当可预测且可验证